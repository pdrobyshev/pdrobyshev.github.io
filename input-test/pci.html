<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Данные об оплате</title>
    <link rel="preload" href="fonts/geometria700.woff2" as="font">
    <link rel="preload" href="fonts/geometria500.woff2" as="font">
    <link rel="stylesheet" href="css/style.min.css">
</head>
<body>
<header class="page-header">
    <h1 class="page-header__title">Данные об оплате</h1>
</header>

<main class="page-main">
    <p class="page-main__text  page-main__text--bold">Для обеспечения безопасности платежа с указанной вами банковской
        карты была списана и возвращена сумма от 1 до 100 тенге.</p>
    <p class="page-main__text">Вам придёт пуш уведомление или смс.</p>
    <p class="page-main__text">Для подтверждения платежа, пожалуйста, укажите списанную сумму и нажмите «Продолжить
        оплату».</p>

    <div class="page-main__inner-wrapper">
        <div class="page-main__row">
            <span class="page-main__info-text">Маска карты:</span>
            <span class="page-main__info-text  page-main__info-text--bold">417663 - ХХ - ХХХХ - 3070</span>
        </div>
        <div class="page-main__row">
            <span class="page-main__info-text">Имя держателя карты:</span>
            <span class="page-main__info-text  page-main__info-text--bold">GAL</span>
        </div>
        <div class="page-main__row">
            <span class="page-main__info-text">Сумма платежа:</span>
            <span class="page-main__info-text  page-main__info-text--bold">10.00 ₸</span>
        </div>

        <form class="payment-form" action="/">
            <label class="field-text">
                Введите заблокированную сумму:
                <input class="field-text__input" id="amount-input" type="text" inputmode="numeric" maxlength="5">
            </label>

            <input class="payment-form__button" type="submit" value="Продолжить оплату">
        </form>
    </div>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="js/jquery.inputmask.js"></script>
<!--  <script src="https://cdn.jsdelivr.net/npm/cleave.js@1.6.0/dist/cleave.min.js"></script>-->
<script>
    // $(document).ready(function () {
    //     var initAmount = parseFloat(0).toFixed(2);
    //     $('#amount-input').val(initAmount);
    // });
    //
    // $('#amount-input').on('focus', function () {
    //     $(this).val('');
    // });

    $(document).ready(function () {
        // $('#amount-input').inputmask({'mask':"9{1,2}.9{1,2}", greedy: false});

        // $('#amount-input').on('input', function (event) {
        //     $(this).val($(this).val().replace(/[^0-9]/g, ''));
        //     if (event.which < 48 || event.which > 57 || event.which !== 8) {
        //
        //     }
        // });

        $('#amount-input').on('keyup', function (event) {
            if (event.which !== 8 && event.which < 48 || event.which > 57) {
                console.log('1st if');
                $(this).val($(this).val().replace(/[^0-9]/g, ''));
            }

            if (event.which >= 48 && event.which <= 57) {
                console.log('2nd if');
                if ($('#amount-input').val().length === 5) {
                    let splitAmount = $('#amount-input').val().split('');
                    let filteredAmount = splitAmount.filter(value => value !== '.');
                    filteredAmount.splice(2, 0, '.');
                    let finalAmount = filteredAmount.join('');
                    $('#amount-input').val(finalAmount);
                } else {
                    let splitAmount = $('#amount-input').val().split('');
                    let filteredAmount = splitAmount.filter(value => value !== '.');
                    filteredAmount.splice(1, 0, '.');
                    let finalAmount = filteredAmount.join('');
                    $('#amount-input').val(finalAmount);
                }
            }
        });

        // var cleaveCustom = new Cleave('#amount-input', {
        //     blocks: [1, 2],
        //     delimiter: '.',
        // });

        // $('#amount-input').on('input', function () {
        //     console.log($(this).val().length);
        //
        //     if ($(this).val().length >= 4) {
        //         cleaveCustom.destroy();
        //
        //         var cleave = new Cleave('#amount-input', {
        //             blocks: [1, 3],
        //             delimiter: '.',
        //         });
        //     }
        // });

        // $('#amount-input').inputmask({
        //     'alias': 'decimal',
        //     'groupSeparator': '.',
        //     'autoGroup': true,
        //     'digits': 2,
        //     'digitsOptional': false,
        //     rightAlign: false,
        //     clearMaskOnLostFocus: !1
        // });

        // $('#amount-input').inputmask({
        //     mask: "9[.99]",
        //     greedy: false,
        //     definitions: {
        //         '*': {
        //             validator: "[0-9]"
        //         }
        //     },
        // });
        //
        // $('#amount-input').on('input', function () {
        //     let splitValue = $('#amount-input').val().split('');
        //
        //     if ($('#amount-input').val().length === 4 && splitValue[splitValue.length - 1] !== '_') {
        //         $('#amount-input').inputmask({
        //             mask: "99[.99]",
        //             greedy: false,
        //             definitions: {
        //                 '*': {
        //                     validator: "[0-9]"
        //                 }
        //             },
        //         });
        //     }
        // });

        // $('#amount-input').inputmask({ mask: "9{1,2}.9{1,2}"})

        // $('#amount-input').inputmask("9{1,2}.99");

        // $('#amount-input').inputmask({mask: "*[.**]", greedy: false, definitions: {'*': {validator: "[0-9]"}}});

        // $('#amount-input').on('input', function () {
        //     $(this).val($(this).val().replace(/[^0-9]/g, ''));
        //     var pattern = /[^\d]+/g;
        //     $(this).val($(this).val().replace(pattern, ''));
        //
        //     var val = $('#amount-input').val();
        //     if ($('#amount-input').val().length === 1) {
        //         $('#amount-input').val(val + '.');
        //     }
        // });
    });
</script>
</body>
</html>
